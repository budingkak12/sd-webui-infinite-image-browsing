import{d as pe,m as F,az as ue,a1 as me,U as p,V as I,c as s,a4 as e,a3 as i,a6 as R,W as d,K as ge,Y as o,X as u,a2 as z,af as fe,aS as ve,$ as _,ag as G,ai as he,T as ke,ak as B,aP as Ie,aQ as _e,bD as we,a0 as Ce}from"./index-40ac36f2.js";import{S as Se}from"./index-7e24fc24.js";import{L as be,R as xe,f as ye,o as Me,_ as Ae}from"./MultiSelectKeep-1264212b.js";import{c as Te,d as Ve,F as $e}from"./FileItem-0284048a.js";import{c as De,u as Fe}from"./hook-91a6d4b5.js";import"./shortcut-8a584dd4.js";import"./Checkbox-15fcde4f.js";/* empty css              */import"./numInput.vue_vue_type_style_index_0_scoped_bd954eda_lang-a3eed423.js";import"./index-819118ae.js";import"./index-79d0524b.js";import"./_isIterateeCall-2083df16.js";import"./useGenInfoDiff-28140e55.js";const Re=r=>(Ie("data-v-f0bfdd51"),r=r(),_e(),r),ze={class:"hint"},Ge={class:"action-bar"},Be=Re(()=>d("div",{style:{padding:"16px 0 512px"}},null,-1)),Ue={key:1},Ne={class:"no-res-hint"},Pe={class:"hint"},Ee={key:2,class:"preview-switch"},Je=pe({__name:"MatchedImageGrid",props:{tabIdx:{},paneIdx:{},selectedTagIds:{},id:{}},setup(r){const g=r,f=De(t=>we(g.selectedTagIds,t)),{queue:U,images:n,onContextMenuClickU:w,stackViewEl:N,previewIdx:c,previewing:C,onPreviewVisibleChange:P,previewImgMove:S,canPreview:b,itemSize:x,gridItems:E,showGenInfo:m,imageGenInfo:y,q:J,multiSelectedIdxs:v,onFileItemClick:L,scroller:M,showMenuIdx:h,onFileDragStart:W,onFileDragEnd:K,cellWidth:O,onScroll:A,saveAllFileAsJson:q,props:Q,saveLoadedFileAsJson:X,changeIndchecked:Y,seedChangeChecked:j,getGenDiff:H,getGenDiffWatchDep:Z}=Fe(f);F(()=>g.selectedTagIds,async()=>{var t;await f.reset(),await ue(),(t=M.value)==null||t.scrollToItem(0),A()},{immediate:!0}),F(()=>g,async t=>{Q.value=t},{deep:!0,immediate:!0});const ee=me(),{onClearAllSelected:te,onSelectAll:le,onReverseSelect:se}=Te(),ne=()=>{n.value.length!==0&&Me(n.value,0)};return(t,l)=>{const ie=Ae,ae=he,oe=ke,k=B,de=B,re=Se;return p(),I("div",{class:"container",ref_key:"stackViewEl",ref:N},[s(ie,{show:!!e(v).length||e(ee).keepMultiSelect,onClearAllSelected:e(te),onSelectAll:e(le),onReverseSelect:e(se)},null,8,["show","onClearAllSelected","onSelectAll","onReverseSelect"]),s(re,{size:"large",spinning:!e(U).isIdle},{default:i(()=>{var T,V,$;return[s(oe,{visible:e(m),"onUpdate:visible":l[1]||(l[1]=a=>R(m)?m.value=a:null),width:"70vw","mask-closable":"",onOk:l[2]||(l[2]=a=>m.value=!1)},{cancelText:i(()=>[]),default:i(()=>[s(ae,{active:"",loading:!e(J).isIdle},{default:i(()=>[d("div",{style:{width:"100%","word-break":"break-all","white-space":"pre-line","max-height":"70vh",overflow:"auto"},onDblclick:l[0]||(l[0]=a=>e(ge)(e(y)))},[d("div",ze,o(t.$t("doubleClickToCopy")),1),u(" "+o(e(y)),1)],32)]),_:1},8,["loading"])]),_:1},8,["visible"]),d("div",Ge,[s(k,{onClick:ne,type:"primary",disabled:!((T=e(n))!=null&&T.length)},{default:i(()=>[u(o(t.$t("tiktokView")),1)]),_:1},8,["disabled"]),s(k,{onClick:e(X)},{default:i(()=>[u(o(t.$t("saveLoadedImageAsJson")),1)]),_:1},8,["onClick"]),s(k,{onClick:e(q)},{default:i(()=>[u(o(t.$t("saveAllAsJson")),1)]),_:1},8,["onClick"])]),(V=e(n))!=null&&V.length?(p(),z(e(Ve),{key:0,ref_key:"scroller",ref:M,class:"file-list",items:e(n),"item-size":e(x).first,"key-field":"fullpath","item-secondary-size":e(x).second,gridItems:e(E),onScroll:e(A)},{after:i(()=>[Be]),default:i(({item:a,index:D})=>[s($e,{idx:D,file:a,"cell-width":e(O),"show-menu-idx":e(h),"onUpdate:showMenuIdx":l[3]||(l[3]=ce=>R(h)?h.value=ce:null),onDragstart:e(W),onDragend:e(K),onFileItemClick:e(L),"full-screen-preview-image-url":e(n)[e(c)]?e(fe)(e(n)[e(c)]):"",selected:e(v).includes(D),onContextMenuClick:e(w),onPreviewVisibleChange:e(P),"is-selected-mutil-files":e(v).length>1,"enable-change-indicator":e(Y),"seed-change-checked":e(j),"get-gen-diff":e(H),"get-gen-diff-watch-dep":e(Z)},null,8,["idx","file","cell-width","show-menu-idx","onDragstart","onDragend","onFileItemClick","full-screen-preview-image-url","selected","onContextMenuClick","onPreviewVisibleChange","is-selected-mutil-files","enable-change-indicator","seed-change-checked","get-gen-diff","get-gen-diff-watch-dep"])]),_:1},8,["items","item-size","item-secondary-size","gridItems","onScroll"])):e(f).load&&t.selectedTagIds.and_tags.length===1&&!(($=t.selectedTagIds.folder_paths_str)!=null&&$.trim())?(p(),I("div",Ue,[d("div",Ne,[d("p",Pe,o(t.$t("tagSearchNoResultsMessage")),1),s(de,{onClick:l[4]||(l[4]=a=>e(ve)()),type:"primary"},{default:i(()=>[u(o(t.$t("rebuildImageIndex")),1)]),_:1})])])):_("",!0),e(C)?(p(),I("div",Ee,[s(e(be),{onClick:l[5]||(l[5]=a=>e(S)("prev")),class:G({disable:!e(b)("prev")})},null,8,["class"]),s(e(xe),{onClick:l[6]||(l[6]=a=>e(S)("next")),class:G({disable:!e(b)("next")})},null,8,["class"])])):_("",!0)]}),_:1},8,["spinning"]),e(C)&&e(n)&&e(n)[e(c)]?(p(),z(ye,{key:0,file:e(n)[e(c)],idx:e(c),onContextMenuClick:e(w)},null,8,["file","idx","onContextMenuClick"])):_("",!0)],512)}}});const lt=Ce(Je,[["__scopeId","data-v-f0bfdd51"]]);export{lt as default};
