var ft=Object.defineProperty;var ht=(i,n,e)=>n in i?ft(i,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[n]=e;var ee=(i,n,e)=>(ht(i,typeof n!="symbol"?n+"":n,e),e);import{d as Z,u as Ue,G as H,an as Je,h as W,c as A,aq as gt,di as pt,r as j,bg as vt,Z as V,dg as mt,P as De,c9 as yt,A as X,dj as de,O as ge,am as ke,bj as bt,d3 as At,b_ as St,dk as kt,cF as It,dl as Ne,dm as _t,p as Ct,dn as We,bA as wt,dp as ae,dq as Et,aH as Tt,dr as Pt,C as Ot,ds as Dt,n as pe,m as re,aT as Nt,t as Ke,a1 as Ie,c7 as qe,aJ as zt,dt as Ge,du as Qt,Q as $t,x as Mt,aP as Ye,aQ as Ze,az as Xe,U as a,a2 as R,dv as Bt,dw as Ft,dx as Rt,c3 as Lt,dy as jt,at as Vt,V as h,aG as te,$ as S,a3 as k,a8 as J,c4 as ze,c5 as Ht,dz as xt,a7 as et,ag as K,X as I,Y as y,a4 as M,al as tt,db as Ut,da as Jt,M as nt,W as u,a0 as it,d5 as Wt,dA as Qe,af as Kt,dB as qt,d8 as Gt,dC as Yt,dD as Zt,cq as Xt,cQ as en,dE as ce,dF as tn,dG as nn}from"./index-a4a82450.js";import"./numInput.vue_vue_type_style_index_0_scoped_55978858_lang-a4be847a.js";import{i as sn}from"./_isIterateeCall-71207d04.js";import{D as G,a as ve}from"./index-6512e834.js";/* empty css              */var rn=function(){return{prefixCls:String,checked:{type:Boolean,default:void 0},onChange:{type:Function},onClick:{type:Function},"onUpdate:checked":Function}},on=Z({compatConfig:{MODE:3},name:"ACheckableTag",props:rn(),setup:function(n,e){var t=e.slots,s=e.emit,o=Ue("tag",n),p=o.prefixCls,c=function(E){var w=n.checked;s("update:checked",!w),s("change",!w),s("click",E)},v=H(function(){var b;return Je(p.value,(b={},W(b,"".concat(p.value,"-checkable"),!0),W(b,"".concat(p.value,"-checkable-checked"),n.checked),b))});return function(){var b;return A("span",{class:v.value,onClick:c},[(b=t.default)===null||b===void 0?void 0:b.call(t)])}}});const me=on;var ln=new RegExp("^(".concat(gt.join("|"),")(-inverse)?$")),an=new RegExp("^(".concat(pt.join("|"),")$")),un=function(){return{prefixCls:String,color:{type:String},closable:{type:Boolean,default:!1},closeIcon:De.any,visible:{type:Boolean,default:void 0},onClose:{type:Function},"onUpdate:visible":Function,icon:De.any}},Y=Z({compatConfig:{MODE:3},name:"ATag",props:un(),slots:["closeIcon","icon"],setup:function(n,e){var t=e.slots,s=e.emit,o=e.attrs,p=Ue("tag",n),c=p.prefixCls,v=p.direction,b=j(!0);vt(function(){n.visible!==void 0&&(b.value=n.visible)});var E=function(r){r.stopPropagation(),s("update:visible",!1),s("close",r),!r.defaultPrevented&&n.visible===void 0&&(b.value=!1)},w=H(function(){var l=n.color;return l?ln.test(l)||an.test(l):!1}),T=H(function(){var l;return Je(c.value,(l={},W(l,"".concat(c.value,"-").concat(n.color),w.value),W(l,"".concat(c.value,"-has-color"),n.color&&!w.value),W(l,"".concat(c.value,"-hidden"),!b.value),W(l,"".concat(c.value,"-rtl"),v.value==="rtl"),l))});return function(){var l,r,d,m=n.icon,N=m===void 0?(l=t.icon)===null||l===void 0?void 0:l.call(t):m,O=n.color,z=n.closeIcon,g=z===void 0?(r=t.closeIcon)===null||r===void 0?void 0:r.call(t):z,f=n.closable,C=f===void 0?!1:f,$=function(){return C?g?A("span",{class:"".concat(c.value,"-close-icon"),onClick:E},[g]):A(yt,{class:"".concat(c.value,"-close-icon"),onClick:E},null):null},F={backgroundColor:O&&!w.value?O:void 0},B=N||null,_=(d=t.default)===null||d===void 0?void 0:d.call(t),L=B?A(V,null,[B,A("span",null,[_])]):_,P="onClick"in o,Q=A("span",{class:T.value,style:F},[L,$()]);return P?A(mt,null,{default:function(){return[Q]}}):Q}}});Y.CheckableTag=me;Y.install=function(i){return i.component(Y.name,Y),i.component(me.name,me),i};const dn=Y;G.Button=ve;G.install=function(i){return i.component(G.name,G),i.component(ve.name,ve),i};var cn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3z"}}]},name:"star",theme:"filled"};const fn=cn;function $e(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},t=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.forEach(function(s){hn(i,s,e[s])})}return i}function hn(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var _e=function(n,e){var t=$e({},n,e.attrs);return A(X,$e({},t,{icon:fn}),null)};_e.displayName="StarFilled";_e.inheritAttrs=!1;const st=_e;var gn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494z"}}]},name:"file",theme:"outlined"};const pn=gn;function Me(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},t=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.forEach(function(s){vn(i,s,e[s])})}return i}function vn(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var Ce=function(n,e){var t=Me({},n,e.attrs);return A(X,Me({},t,{icon:pn}),null)};Ce.displayName="FileOutlined";Ce.inheritAttrs=!1;const mn=Ce;var yn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 444H820V330.4c0-17.7-14.3-32-32-32H473L355.7 186.2a8.15 8.15 0 00-5.5-2.2H96c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h698c13 0 24.8-7.9 29.7-20l134-332c1.5-3.8 2.3-7.9 2.3-12 0-17.7-14.3-32-32-32zM136 256h188.5l119.6 114.4H748V444H238c-13 0-24.8 7.9-29.7 20L136 643.2V256zm635.3 512H159l103.3-256h612.4L771.3 768z"}}]},name:"folder-open",theme:"outlined"};const bn=yn;function Be(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},t=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.forEach(function(s){An(i,s,e[s])})}return i}function An(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var we=function(n,e){var t=Be({},n,e.attrs);return A(X,Be({},t,{icon:bn}),null)};we.displayName="FolderOpenOutlined";we.inheritAttrs=!1;const Sn=we;function kn(i){return i&&i.length?i[0]:void 0}var In=Math.ceil,_n=Math.max;function Cn(i,n,e,t){for(var s=-1,o=_n(In((n-i)/(e||1)),0),p=Array(o);o--;)p[t?o:++s]=i,i+=e;return p}function wn(i){return function(n,e,t){return t&&typeof t!="number"&&sn(n,e,t)&&(e=t=void 0),n=de(n),e===void 0?(e=n,n=0):e=de(e),t=t===void 0?n<e?1:-1:de(t),Cn(n,e,t,i)}}var En=wn();const Tn=En,Pn="data:image/png;base64,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",ne=new WeakMap;function On(i,n){return{useHookShareState:t=>{const s=St();ge(s),ne.has(s)||(ne.set(s,ke(i(s,t??(n==null?void 0:n())))),bt(()=>{ne.delete(s)}));const o=ne.get(s);return ge(o),{state:o,toRefs(){return At(o)}}}}}var Dn={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"}}]},name:"caret-right",theme:"outlined"};const Nn=Dn;function Fe(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},t=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.forEach(function(s){zn(i,s,e[s])})}return i}function zn(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var Ee=function(n,e){var t=Fe({},n,e.attrs);return A(X,Fe({},t,{icon:Nn}),null)};Ee.displayName="CaretRightOutlined";Ee.inheritAttrs=!1;const Re=Ee;var Qn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 00.6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0046.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3zM664.8 561.6l36.1 210.3L512 672.7 323.1 772l36.1-210.3-152.8-149L417.6 382 512 190.7 606.4 382l211.2 30.7-152.8 148.9z"}}]},name:"star",theme:"outlined"};const $n=Qn;function Le(i){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},t=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(t=t.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.forEach(function(s){Mn(i,s,e[s])})}return i}function Mn(i,n,e){return n in i?Object.defineProperty(i,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[n]=e,i}var Te=function(n,e){var t=Le({},n,e.attrs);return A(X,Le({},t,{icon:$n}),null)};Te.displayName="StarOutlined";Te.inheritAttrs=!1;const rt=Te,Bn="/infinite_image_browsing/fe-static/assets/play-68f5544d.svg",Fn=kt("useBatchDownloadStore",()=>{const i=j([]);return{selectdFiles:i,addFiles:e=>{i.value=It([...i.value,...e])}}});class oe{constructor(n,e=_t.CREATED_TIME_DESC){ee(this,"root");ee(this,"execQueue",[]);ee(this,"walkerInitPromsie");this.entryPath=n,this.sortMethod=e,this.root={children:[],info:{name:this.entryPath,size:"-",bytes:0,created_time:"",is_under_scanned_path:!0,date:"",type:"dir",fullpath:this.entryPath}},this.walkerInitPromsie=new Promise(t=>{Ne([this.entryPath]).then(async s=>{this.root.info=s[this.entryPath],await this.fetchChildren(this.root),t()})})}reset(){return this.root.children=[],this.fetchChildren(this.root)}get images(){const n=e=>e.children.map(t=>{if(t.info.type==="dir")return n(t);if(ae(t.info.name))return t.info}).filter(t=>t).flat(1);return n(this.root)}get isCompleted(){return this.execQueue.length===0}async fetchChildren(n){const{files:e}=await Ct(n.info.fullpath);return n.children=We(e,this.sortMethod).map(t=>({info:t,children:[]})),this.execQueue.shift(),this.execQueue.unshift(...n.children.filter(t=>t.info.type==="dir").map(t=>({fn:()=>this.fetchChildren(t),...t}))),n}async next(){await this.walkerInitPromsie;const n=kn(this.execQueue);if(!n)return null;const e=await n.fn();return this.execQueue=this.execQueue.slice(),this.root={...this.root},e}async isExpired(){const n=[this.root.info],e=s=>{for(const o of s.children)o.info.type==="dir"&&(n.push(o.info),e(o))};e(this.root);const t=await Ne(n.map(s=>s.fullpath));for(const s of n)if(!wt(s,t[s.fullpath]))return!0;return!1}async seamlessRefresh(n,e=j(!1)){const t=performance.now(),s=new oe(this.entryPath,this.sortMethod);for(await s.walkerInitPromsie;!s.isCompleted&&s.images.length<n;){if(e.value)throw new Error("canceled");await s.next()}const o=performance.now();return console.log("seamlessRefresh currPos:",n,"Time taken:",(o-t).toFixed(0),"ms"),s}}var ot={exports:{}};/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT */(function(i,n){(function(e,t){i.exports=t})(Et,function(){var e={};e.version="0.3.5";var t=e.settings={minimum:.08,easing:"linear",positionUsing:"",speed:200,trickle:!0,trickleSpeed:200,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};e.configure=function(r){var d,m;for(d in r)m=r[d],m!==void 0&&r.hasOwnProperty(d)&&(t[d]=m);return this},e.status=null,e.set=function(r){var d=e.isStarted();r=s(r,t.minimum,1),e.status=r===1?null:r;var m=e.render(!d),N=m.querySelector(t.barSelector),O=t.speed,z=t.easing;return m.offsetWidth,c(function(g){t.positionUsing===""&&(t.positionUsing=e.getPositioningCSS()),v(N,p(r,O,z)),r===1?(v(m,{transition:"none",opacity:1}),m.offsetWidth,setTimeout(function(){v(m,{transition:"all "+O+"ms linear",opacity:0}),setTimeout(function(){e.remove(),g()},O)},O)):setTimeout(g,O)}),this},e.isStarted=function(){return typeof e.status=="number"},e.start=function(){e.status||e.set(0);var r=function(){setTimeout(function(){e.status&&(e.trickle(),r())},t.trickleSpeed)};return t.trickle&&r(),this},e.done=function(r){return!r&&!e.status?this:e.inc(.3+.5*Math.random()).set(1)},e.inc=function(r){var d=e.status;return d?d>1?void 0:(typeof r!="number"&&(d>=0&&d<.2?r=.1:d>=.2&&d<.5?r=.04:d>=.5&&d<.8?r=.02:d>=.8&&d<.99?r=.005:r=0),d=s(d+r,0,.994),e.set(d)):e.start()},e.trickle=function(){return e.inc()},function(){var r=0,d=0;e.promise=function(m){return!m||m.state()==="resolved"?this:(d===0&&e.start(),r++,d++,m.always(function(){d--,d===0?(r=0,e.done()):e.set((r-d)/r)}),this)}}(),e.getElement=function(){var r=e.getParent();if(r){var d=Array.prototype.slice.call(r.querySelectorAll(".nprogress")).filter(function(m){return m.parentElement===r});if(d.length>0)return d[0]}return null},e.getParent=function(){if(t.parent instanceof HTMLElement)return t.parent;if(typeof t.parent=="string")return document.querySelector(t.parent)},e.render=function(r){if(e.isRendered())return e.getElement();E(document.documentElement,"nprogress-busy");var d=document.createElement("div");d.id="nprogress",d.className="nprogress",d.innerHTML=t.template;var m=d.querySelector(t.barSelector),N=r?"-100":o(e.status||0),O=e.getParent(),z;return v(m,{transition:"all 0 linear",transform:"translate3d("+N+"%,0,0)"}),t.showSpinner||(z=d.querySelector(t.spinnerSelector),z&&l(z)),O!=document.body&&E(O,"nprogress-custom-parent"),O.appendChild(d),d},e.remove=function(){e.status=null,w(document.documentElement,"nprogress-busy"),w(e.getParent(),"nprogress-custom-parent");var r=e.getElement();r&&l(r)},e.isRendered=function(){return!!e.getElement()},e.getPositioningCSS=function(){var r=document.body.style,d="WebkitTransform"in r?"Webkit":"MozTransform"in r?"Moz":"msTransform"in r?"ms":"OTransform"in r?"O":"";return d+"Perspective"in r?"translate3d":d+"Transform"in r?"translate":"margin"};function s(r,d,m){return r<d?d:r>m?m:r}function o(r){return(-1+r)*100}function p(r,d,m){var N;return t.positionUsing==="translate3d"?N={transform:"translate3d("+o(r)+"%,0,0)"}:t.positionUsing==="translate"?N={transform:"translate("+o(r)+"%,0)"}:N={"margin-left":o(r)+"%"},N.transition="all "+d+"ms "+m,N}var c=function(){var r=[];function d(){var m=r.shift();m&&m(d)}return function(m){r.push(m),r.length==1&&d()}}(),v=function(){var r=["Webkit","O","Moz","ms"],d={};function m(g){return g.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(f,C){return C.toUpperCase()})}function N(g){var f=document.body.style;if(g in f)return g;for(var C=r.length,$=g.charAt(0).toUpperCase()+g.slice(1),F;C--;)if(F=r[C]+$,F in f)return F;return g}function O(g){return g=m(g),d[g]||(d[g]=N(g))}function z(g,f,C){f=O(f),g.style[f]=C}return function(g,f){var C=arguments,$,F;if(C.length==2)for($ in f)F=f[$],F!==void 0&&f.hasOwnProperty($)&&z(g,$,F);else z(g,C[1],C[2])}}();function b(r,d){var m=typeof r=="string"?r:T(r);return m.indexOf(" "+d+" ")>=0}function E(r,d){var m=T(r),N=m+d;b(m,d)||(r.className=N.substring(1))}function w(r,d){var m=T(r),N;b(r,d)&&(N=m.replace(" "+d+" "," "),r.className=N.substring(1,N.length-1))}function T(r){return(" "+(r&&r.className||"")+" ").replace(/\s+/gi," ")}function l(r){r&&r.parentNode&&r.parentNode.removeChild(r)}return e})})(ot);var Rn=ot.exports;const sr=Tt(Rn);function rr({fetchNext:i}={}){const{scroller:n,sortedFiles:e,sortMethod:t,currLocation:s,stackViewEl:o,canLoadNext:p,previewIdx:c,props:v,walker:b,getViewableAreaFiles:E}=le().toRefs(),{state:w}=le(),T=j(!1),l=j(q.defaultGridCellWidth),r=H(()=>l.value+16),d=44,{width:m}=Pt(o),N=H(()=>~~(m.value/r.value)),O=ke(new Map),z=H(()=>{const B=r.value;return{first:B+(l.value<=160?0:d),second:B}}),g=j(!1),f=async()=>{var B;if(!(g.value||v.value.mode!=="walk"||!p.value))try{g.value=!0,await((B=b.value)==null?void 0:B.next())}finally{g.value=!1}},C=async(B=!1)=>{const _=n.value,L=()=>B?c.value:(_==null?void 0:_.$_endIndex)??0,P=()=>{const Q=e.value.length,x=50;return Q?i?L()>Q-x:L()>Q-x&&p.value:!0};for(;P();){await Ke(30);const Q=await(i??f)();if(typeof Q=="boolean"&&!Q)return}};w.useEventListen("loadNextDir",Ot(async(B=!1)=>{await C(B),v.value.mode==="walk"&&$()})),w.useEventListen("viewableAreaFilesChange",()=>{const B=E.value(),_=B.filter(P=>P.is_under_scanned_path&&ae(P.name)).map(P=>P.fullpath);Ln.fetchImageTags(_);const L=B.filter(P=>P.is_under_scanned_path&&P.type==="dir"&&!O.has(P.fullpath)).map(P=>P.fullpath);L.length&&Dt(L).then(P=>{for(const Q in P)if(Object.prototype.hasOwnProperty.call(P,Q)){const x=P[Q];O.set(Q,x)}})}),w.useEventListen("refresh",async()=>{w.eventEmitter.emit("viewableAreaFilesChange")});const $=pe(()=>w.eventEmitter.emit("viewableAreaFilesChange"),300);re(s,$);const F=pe(async()=>{await C(),$()},150);return{gridItems:N,sortedFiles:e,sortMethodConv:Nt,moreActionsDropdownShow:T,gridSize:r,sortMethod:t,onScroll:F,loadNextDir:f,loadNextDirLoading:g,canLoadNext:p,itemSize:z,cellWidth:l,dirCoverCache:O}}const or=new Map,q=Ie(),lr=Fn(),Ln=qe(),ar=zt(),ur=new BroadcastChannel("iib-image-transfer-bus"),{eventEmitter:dr,useEventListen:cr}=Ge(),{useHookShareState:le}=On((i,{images:n})=>{const e=j({tabIdx:-1,paneIdx:-1}),t=H(()=>$t(s.value)),s=j([]),o=H(()=>{var f;return s.value.map(C=>C.curr).slice((f=q.conf)!=null&&f.is_win&&e.value.mode!=="scanned-fixed"?1:0)}),p=H(()=>Mt(...o.value)),c=H(()=>{var f,C;return e.value.mode==="scanned-fixed"?((C=(f=s.value)==null?void 0:f[0])==null?void 0:C.curr)??"":e.value.mode==="walk"?e.value.path??"":s.value.length===1?"/":p.value}),v=j(q.defaultSortingMethod),b=j(e.value.mode=="walk"?new oe(e.value.path,v.value):void 0);re([()=>e.value.mode,()=>e.value.path,v],async([f,C,$])=>{var F;f==="walk"?(b.value=new oe(C,$),s.value=[{files:[],curr:C}],await Ke(),await((F=b.value)==null?void 0:F.reset()),z.eventEmitter.emit("loadNextDir")):b.value=void 0});const E=ke(new Set);re(t,()=>E.clear());const w=H(()=>{var F;if(n.value)return n.value;if(b.value)return b.value.images.filter(B=>!E.has(B.fullpath));if(!t.value)return[];const f=((F=t.value)==null?void 0:F.files)??[],C=v.value;return We((B=>q.onlyFoldersAndImages?B.filter(_=>_.type==="dir"||ae(_.name)):B)(f),C).filter(B=>!E.has(B.fullpath))}),T=j([]),l=j(-1),r=H(()=>b.value?!b.value.isCompleted:!1),d=j(!1),m=j(!1),N=j(),O=()=>{var f,C,$;return($=(C=(f=q.tabList)==null?void 0:f[e.value.tabIdx])==null?void 0:C.panes)==null?void 0:$[e.value.paneIdx]},z=Ge();z.useEventListen("selectAll",()=>{console.log(`select all 0 -> ${w.value.length}`),T.value=Tn(0,w.value.length)});const g=()=>{const f=N.value;if(f){const C=Math.max(f.$_startIndex-10,0);return w.value.slice(C,f.$_endIndex+10)}return[]};return{previewing:m,spinning:d,canLoadNext:r,multiSelectedIdxs:T,previewIdx:l,basePath:o,currLocation:c,currPage:t,stack:s,sortMethod:v,sortedFiles:w,scroller:N,stackViewEl:j(),props:e,getPane:O,walker:b,deletedFiles:E,getViewableAreaFiles:g,...z}},()=>({images:j()}));function fr(){const{eventEmitter:i,multiSelectedIdxs:n,sortedFiles:e}=le().toRefs();return{onSelectAll:()=>i.value.emit("selectAll"),onReverseSelect:()=>{n.value=e.value.map((p,c)=>c).filter(p=>!n.value.includes(p))},onClearAllSelected:()=>{n.value=[]}}}const hr=()=>{const{stackViewEl:i}=le().toRefs(),n=j(-1);return Qt(i,e=>{var s;let t=e.target;for(;t.parentElement;)if(t=t.parentElement,t.tagName.toLowerCase()==="li"&&t.classList.contains("file-item-trigger")){const o=(s=t.dataset)==null?void 0:s.idx;o&&Number.isSafeInteger(+o)&&(n.value=+o);return}}),{showMenuIdx:n}};function jn(){var i=window.navigator.userAgent,n=i.indexOf("MSIE ");if(n>0)return parseInt(i.substring(n+5,i.indexOf(".",n)),10);var e=i.indexOf("Trident/");if(e>0){var t=i.indexOf("rv:");return parseInt(i.substring(t+3,i.indexOf(".",t)),10)}var s=i.indexOf("Edge/");return s>0?parseInt(i.substring(s+5,i.indexOf(".",s)),10):-1}let ie;function ye(){ye.init||(ye.init=!0,ie=jn()!==-1)}var ue={name:"ResizeObserver",props:{emitOnMount:{type:Boolean,default:!1},ignoreWidth:{type:Boolean,default:!1},ignoreHeight:{type:Boolean,default:!1}},emits:["notify"],mounted(){ye(),Xe(()=>{this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitOnMount&&this.emitSize()});const i=document.createElement("object");this._resizeObject=i,i.setAttribute("aria-hidden","true"),i.setAttribute("tabindex",-1),i.onload=this.addResizeHandlers,i.type="text/html",ie&&this.$el.appendChild(i),i.data="about:blank",ie||this.$el.appendChild(i)},beforeUnmount(){this.removeResizeHandlers()},methods:{compareAndNotify(){(!this.ignoreWidth&&this._w!==this.$el.offsetWidth||!this.ignoreHeight&&this._h!==this.$el.offsetHeight)&&(this._w=this.$el.offsetWidth,this._h=this.$el.offsetHeight,this.emitSize())},emitSize(){this.$emit("notify",{width:this._w,height:this._h})},addResizeHandlers(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.compareAndNotify),this.compareAndNotify()},removeResizeHandlers(){this._resizeObject&&this._resizeObject.onload&&(!ie&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.compareAndNotify),this.$el.removeChild(this._resizeObject),this._resizeObject.onload=null,this._resizeObject=null)}}};const Vn=Bt();Ye("data-v-b329ee4c");const Hn={class:"resize-observer",tabindex:"-1"};Ze();const xn=Vn((i,n,e,t,s,o)=>(a(),R("div",Hn)));ue.render=xn;ue.__scopeId="data-v-b329ee4c";ue.__file="src/components/ResizeObserver.vue";function se(i){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?se=function(n){return typeof n}:se=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},se(i)}function Un(i,n){if(!(i instanceof n))throw new TypeError("Cannot call a class as a function")}function je(i,n){for(var e=0;e<n.length;e++){var t=n[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(i,t.key,t)}}function Jn(i,n,e){return n&&je(i.prototype,n),e&&je(i,e),i}function Ve(i){return Wn(i)||Kn(i)||qn(i)||Gn()}function Wn(i){if(Array.isArray(i))return be(i)}function Kn(i){if(typeof Symbol<"u"&&Symbol.iterator in Object(i))return Array.from(i)}function qn(i,n){if(i){if(typeof i=="string")return be(i,n);var e=Object.prototype.toString.call(i).slice(8,-1);if(e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set")return Array.from(i);if(e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return be(i,n)}}function be(i,n){(n==null||n>i.length)&&(n=i.length);for(var e=0,t=new Array(n);e<n;e++)t[e]=i[e];return t}function Gn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yn(i){var n;return typeof i=="function"?n={callback:i}:n=i,n}function Zn(i,n){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t,s,o,p=function(v){for(var b=arguments.length,E=new Array(b>1?b-1:0),w=1;w<b;w++)E[w-1]=arguments[w];if(o=E,!(t&&v===s)){var T=e.leading;typeof T=="function"&&(T=T(v,s)),(!t||v!==s)&&T&&i.apply(void 0,[v].concat(Ve(o))),s=v,clearTimeout(t),t=setTimeout(function(){i.apply(void 0,[v].concat(Ve(o))),t=0},n)}};return p._clear=function(){clearTimeout(t),t=null},p}function lt(i,n){if(i===n)return!0;if(se(i)==="object"){for(var e in i)if(!lt(i[e],n[e]))return!1;return!0}return!1}var Xn=function(){function i(n,e,t){Un(this,i),this.el=n,this.observer=null,this.frozen=!1,this.createObserver(e,t)}return Jn(i,[{key:"createObserver",value:function(e,t){var s=this;if(this.observer&&this.destroyObserver(),!this.frozen){if(this.options=Yn(e),this.callback=function(c,v){s.options.callback(c,v),c&&s.options.once&&(s.frozen=!0,s.destroyObserver())},this.callback&&this.options.throttle){var o=this.options.throttleOptions||{},p=o.leading;this.callback=Zn(this.callback,this.options.throttle,{leading:function(v){return p==="both"||p==="visible"&&v||p==="hidden"&&!v}})}this.oldResult=void 0,this.observer=new IntersectionObserver(function(c){var v=c[0];if(c.length>1){var b=c.find(function(w){return w.isIntersecting});b&&(v=b)}if(s.callback){var E=v.isIntersecting&&v.intersectionRatio>=s.threshold;if(E===s.oldResult)return;s.oldResult=E,s.callback(E,v)}},this.options.intersection),Xe(function(){s.observer&&s.observer.observe(s.el)})}}},{key:"destroyObserver",value:function(){this.observer&&(this.observer.disconnect(),this.observer=null),this.callback&&this.callback._clear&&(this.callback._clear(),this.callback=null)}},{key:"threshold",get:function(){return this.options.intersection&&typeof this.options.intersection.threshold=="number"?this.options.intersection.threshold:0}}]),i}();function at(i,n,e){var t=n.value;if(t)if(typeof IntersectionObserver>"u")console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var s=new Xn(i,t,e);i._vue_visibilityState=s}}function ei(i,n,e){var t=n.value,s=n.oldValue;if(!lt(t,s)){var o=i._vue_visibilityState;if(!t){ut(i);return}o?o.createObserver(t,e):at(i,{value:t},e)}}function ut(i){var n=i._vue_visibilityState;n&&(n.destroyObserver(),delete i._vue_visibilityState)}var ti={beforeMount:at,updated:ei,unmounted:ut},ni={itemsLimit:1e3},ii=/(auto|scroll)/;function dt(i,n){return i.parentNode===null?n:dt(i.parentNode,n.concat([i]))}var fe=function(n,e){return getComputedStyle(n,null).getPropertyValue(e)},si=function(n){return fe(n,"overflow")+fe(n,"overflow-y")+fe(n,"overflow-x")},ri=function(n){return ii.test(si(n))};function He(i){if(i instanceof HTMLElement||i instanceof SVGElement){for(var n=dt(i.parentNode,[]),e=0;e<n.length;e+=1)if(ri(n[e]))return n[e];return document.scrollingElement||document.documentElement}}function Ae(i){"@babel/helpers - typeof";return Ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Ae(i)}var oi={items:{type:Array,required:!0},keyField:{type:String,default:"id"},direction:{type:String,default:"vertical",validator:function(n){return["vertical","horizontal"].includes(n)}},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"}};function li(){return this.items.length&&Ae(this.items[0])!=="object"}var Se=!1;if(typeof window<"u"){Se=!1;try{var ai=Object.defineProperty({},"passive",{get:function(){Se=!0}});window.addEventListener("test",null,ai)}catch{}}let ui=0;var ct={name:"RecycleScroller",components:{ResizeObserver:ue},directives:{ObserveVisibility:ti},props:{...oi,itemSize:{type:Number,default:null},gridItems:{type:Number,default:void 0},itemSecondarySize:{type:Number,default:void 0},minItemSize:{type:[Number,String],default:null},sizeField:{type:String,default:"size"},typeField:{type:String,default:"type"},buffer:{type:Number,default:200},pageMode:{type:Boolean,default:!1},prerender:{type:Number,default:0},emitUpdate:{type:Boolean,default:!1},updateInterval:{type:Number,default:0},skipHover:{type:Boolean,default:!1},listTag:{type:String,default:"div"},itemTag:{type:String,default:"div"},listClass:{type:[String,Object,Array],default:""},itemClass:{type:[String,Object,Array],default:""}},emits:["resize","visible","hidden","update","scroll-start","scroll-end"],data(){return{pool:[],totalSize:0,ready:!1,hoverKey:null}},computed:{sizes(){if(this.itemSize===null){const i={"-1":{accumulator:0}},n=this.items,e=this.sizeField,t=this.minItemSize;let s=1e4,o=0,p;for(let c=0,v=n.length;c<v;c++)p=n[c][e]||t,p<s&&(s=p),o+=p,i[c]={accumulator:o,size:p};return this.$_computedMinItemSize=s,i}return[]},simpleArray:li,itemIndexByKey(){const{keyField:i,items:n}=this,e={};for(let t=0,s=n.length;t<s;t++)e[n[t][i]]=t;return e}},watch:{items(){this.updateVisibleItems(!0)},pageMode(){this.applyPageMode(),this.updateVisibleItems(!1)},sizes:{handler(){this.updateVisibleItems(!1)},deep:!0},gridItems(){this.updateVisibleItems(!0)},itemSecondarySize(){this.updateVisibleItems(!0)}},created(){this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1,this.$_lastUpdateScrollPosition=0,this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1)),this.gridItems&&!this.itemSize&&console.error("[vue-recycle-scroller] You must provide an itemSize when using gridItems")},mounted(){this.applyPageMode(),this.$nextTick(()=>{this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0})},activated(){const i=this.$_lastUpdateScrollPosition;typeof i=="number"&&this.$nextTick(()=>{this.scrollToPosition(i)})},beforeUnmount(){this.removeListeners()},methods:{addView(i,n,e,t,s){const o=Ft({id:ui++,index:n,used:!0,key:t,type:s}),p=Rt({item:e,position:0,nr:o});return i.push(p),p},unuseView(i,n=!1){const e=this.$_unusedViews,t=i.nr.type;let s=e.get(t);s||(s=[],e.set(t,s)),s.push(i),n||(i.nr.used=!1,i.position=-9999)},handleResize(){this.$emit("resize"),this.ready&&this.updateVisibleItems(!1)},handleScroll(i){if(!this.$_scrollDirty){if(this.$_scrollDirty=!0,this.$_updateTimeout)return;const n=()=>requestAnimationFrame(()=>{this.$_scrollDirty=!1;const{continuous:e}=this.updateVisibleItems(!1,!0);e||(clearTimeout(this.$_refreshTimout),this.$_refreshTimout=setTimeout(this.handleScroll,this.updateInterval+100))});n(),this.updateInterval&&(this.$_updateTimeout=setTimeout(()=>{this.$_updateTimeout=0,this.$_scrollDirty&&n()},this.updateInterval))}},handleVisibilityChange(i,n){this.ready&&(i||n.boundingClientRect.width!==0||n.boundingClientRect.height!==0?(this.$emit("visible"),requestAnimationFrame(()=>{this.updateVisibleItems(!1)})):this.$emit("hidden"))},updateVisibleItems(i,n=!1){const e=this.itemSize,t=this.gridItems||1,s=this.itemSecondarySize||e,o=this.$_computedMinItemSize,p=this.typeField,c=this.simpleArray?null:this.keyField,v=this.items,b=v.length,E=this.sizes,w=this.$_views,T=this.$_unusedViews,l=this.pool,r=this.itemIndexByKey;let d,m,N,O,z;if(!b)d=m=O=z=N=0;else if(this.$_prerender)d=O=0,m=z=Math.min(this.prerender,v.length),N=null;else{const _=this.getScroll();if(n){let Q=_.start-this.$_lastUpdateScrollPosition;if(Q<0&&(Q=-Q),e===null&&Q<o||Q<e)return{continuous:!0}}this.$_lastUpdateScrollPosition=_.start;const L=this.buffer;_.start-=L,_.end+=L;let P=0;if(this.$refs.before&&(P=this.$refs.before.scrollHeight,_.start-=P),this.$refs.after){const Q=this.$refs.after.scrollHeight;_.end+=Q}if(e===null){let Q,x=0,Pe=b-1,U=~~(b/2),Oe;do Oe=U,Q=E[U].accumulator,Q<_.start?x=U:U<b-1&&E[U+1].accumulator>_.start&&(Pe=U),U=~~((x+Pe)/2);while(U!==Oe);for(U<0&&(U=0),d=U,N=E[b-1].accumulator,m=U;m<b&&E[m].accumulator<_.end;m++);for(m===-1?m=v.length-1:(m++,m>b&&(m=b)),O=d;O<b&&P+E[O].accumulator<_.start;O++);for(z=O;z<b&&P+E[z].accumulator<_.end;z++);}else{d=~~(_.start/e*t);const Q=d%t;d-=Q,m=Math.ceil(_.end/e*t),O=Math.max(0,Math.floor((_.start-P)/e*t)),z=Math.floor((_.end-P)/e*t),d<0&&(d=0),m>b&&(m=b),O<0&&(O=0),z>b&&(z=b),N=Math.ceil(b/t)*e}}m-d>ni.itemsLimit&&this.itemsLimitError(),this.totalSize=N;let g;const f=d<=this.$_endIndex&&m>=this.$_startIndex;if(f)for(let _=0,L=l.length;_<L;_++)g=l[_],g.nr.used&&(i&&(g.nr.index=r[g.item[c]]),(g.nr.index==null||g.nr.index<d||g.nr.index>=m)&&this.unuseView(g));const C=f?null:new Map;let $,F,B;for(let _=d;_<m;_++){$=v[_];const L=c?$[c]:$;if(L==null)throw new Error(`Key is ${L} on item (keyField is '${c}')`);if(g=w.get(L),!e&&!E[_].size){g&&this.unuseView(g);continue}F=$[p];let P=T.get(F),Q=!1;if(!g)f?P&&P.length?g=P.pop():g=this.addView(l,_,$,L,F):(B=C.get(F)||0,(!P||B>=P.length)&&(g=this.addView(l,_,$,L,F),this.unuseView(g,!0),P=T.get(F)),g=P[B],C.set(F,B+1)),w.delete(g.nr.key),g.nr.used=!0,g.nr.index=_,g.nr.key=L,g.nr.type=F,w.set(L,g),Q=!0;else if(!g.nr.used&&(g.nr.used=!0,g.nr.index=_,Q=!0,P)){const x=P.indexOf(g);x!==-1&&P.splice(x,1)}g.item=$,Q&&(_===v.length-1&&this.$emit("scroll-end"),_===0&&this.$emit("scroll-start")),e===null?(g.position=E[_-1].accumulator,g.offset=0):(g.position=Math.floor(_/t)*e,g.offset=_%t*s)}return this.$_startIndex=d,this.$_endIndex=m,this.emitUpdate&&this.$emit("update",d,m,O,z),clearTimeout(this.$_sortTimer),this.$_sortTimer=setTimeout(this.sortViews,this.updateInterval+300),{continuous:f}},getListenerTarget(){let i=He(this.$el);return window.document&&(i===window.document.documentElement||i===window.document.body)&&(i=window),i},getScroll(){const{$el:i,direction:n}=this,e=n==="vertical";let t;if(this.pageMode){const s=i.getBoundingClientRect(),o=e?s.height:s.width;let p=-(e?s.top:s.left),c=e?window.innerHeight:window.innerWidth;p<0&&(c+=p,p=0),p+c>o&&(c=o-p),t={start:p,end:p+c}}else e?t={start:i.scrollTop,end:i.scrollTop+i.clientHeight}:t={start:i.scrollLeft,end:i.scrollLeft+i.clientWidth};return t},applyPageMode(){this.pageMode?this.addListeners():this.removeListeners()},addListeners(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,Se?{passive:!0}:!1),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem(i){let n;const e=this.gridItems||1;this.itemSize===null?n=i>0?this.sizes[i-1].accumulator:0:n=Math.floor(i/e)*this.itemSize,this.scrollToPosition(n)},scrollToPosition(i){const n=this.direction==="vertical"?{scroll:"scrollTop",start:"top"}:{scroll:"scrollLeft",start:"left"};let e,t,s;if(this.pageMode){const o=He(this.$el),p=o.tagName==="HTML"?0:o[n.scroll],c=o.getBoundingClientRect(),b=this.$el.getBoundingClientRect()[n.start]-c[n.start];e=o,t=n.scroll,s=i+p+b}else e=this.$el,t=n.scroll,s=i;e[t]=s},itemsLimitError(){throw setTimeout(()=>{console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",this.$el),console.log("Make sure the scroller has a fixed height (or width) and 'overflow-y' (or 'overflow-x') set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")}),new Error("Rendered items limit reached")},sortViews(){this.pool.sort((i,n)=>i.nr.index-n.nr.index)}}};const di={key:0,ref:"before",class:"vue-recycle-scroller__slot"},ci={key:1,ref:"after",class:"vue-recycle-scroller__slot"};function fi(i,n,e,t,s,o){const p=Lt("ResizeObserver"),c=jt("observe-visibility");return Vt((a(),h("div",{class:K(["vue-recycle-scroller",{ready:s.ready,"page-mode":e.pageMode,[`direction-${i.direction}`]:!0}]),onScrollPassive:n[0]||(n[0]=(...v)=>o.handleScroll&&o.handleScroll(...v))},[i.$slots.before?(a(),h("div",di,[te(i.$slots,"before")],512)):S("v-if",!0),(a(),R(ze(e.listTag),{ref:"wrapper",style:et({[i.direction==="vertical"?"minHeight":"minWidth"]:s.totalSize+"px"}),class:K(["vue-recycle-scroller__item-wrapper",e.listClass])},{default:k(()=>[(a(!0),h(V,null,J(s.pool,v=>(a(),R(ze(e.itemTag),Ht({key:v.nr.id,style:s.ready?{transform:`translate${i.direction==="vertical"?"Y":"X"}(${v.position}px) translate${i.direction==="vertical"?"X":"Y"}(${v.offset}px)`,width:e.gridItems?`${i.direction==="vertical"&&e.itemSecondarySize||e.itemSize}px`:void 0,height:e.gridItems?`${i.direction==="horizontal"&&e.itemSecondarySize||e.itemSize}px`:void 0}:null,class:["vue-recycle-scroller__item-view",[e.itemClass,{hover:!e.skipHover&&s.hoverKey===v.nr.key}]]},xt(e.skipHover?{}:{mouseenter:()=>{s.hoverKey=v.nr.key},mouseleave:()=>{s.hoverKey=null}})),{default:k(()=>[te(i.$slots,"default",{item:v.item,index:v.nr.index,active:v.nr.used})]),_:2},1040,["style","class"]))),128)),te(i.$slots,"empty")]),_:3},8,["style","class"])),i.$slots.after?(a(),h("div",ci,[te(i.$slots,"after")],512)):S("v-if",!0),A(p,{onNotify:o.handleResize},null,8,["onNotify"])],34)),[[c,o.handleVisibilityChange]])}ct.render=fi;ct.__file="src/components/RecycleScroller.vue";const xe=Z({__name:"ContextMenu",props:{file:{},idx:{},selectedTag:{},isSelectedMutilFiles:{type:Boolean}},emits:["contextMenuClick"],setup(i,{emit:n}){const e=i,t=Ie(),s=H(()=>{var o;return(((o=t.conf)==null?void 0:o.all_custom_tags)??[]).reduce((p,c)=>[...p,{...c,selected:!!e.selectedTag.find(v=>v.id===c.id)}],[])});return(o,p)=>{const c=tt,v=Ut,b=Jt,E=nt;return a(),R(E,{onClick:p[0]||(p[0]=w=>n("contextMenuClick",w,o.file,o.idx))},{default:k(()=>{var w;return[A(c,{key:"deleteFiles"},{default:k(()=>[I(y(o.$t("deleteSelected")),1)]),_:1}),A(c,{key:"openWithDefaultApp"},{default:k(()=>[I(y(o.$t("openWithDefaultApp")),1)]),_:1}),A(c,{key:"saveSelectedAsJson"},{default:k(()=>[I(y(o.$t("saveSelectedAsJson")),1)]),_:1}),o.file.type==="dir"?(a(),h(V,{key:0},[A(c,{key:"openInNewTab"},{default:k(()=>[I(y(o.$t("openInNewTab")),1)]),_:1}),A(c,{key:"openOnTheRight"},{default:k(()=>[I(y(o.$t("openOnTheRight")),1)]),_:1}),A(c,{key:"openWithWalkMode"},{default:k(()=>[I(y(o.$t("openWithWalkMode")),1)]),_:1})],64)):S("",!0),o.file.type==="file"?(a(),h(V,{key:1},[M(ae)(o.file.name)?(a(),h(V,{key:0},[A(c,{key:"viewGenInfo"},{default:k(()=>[I(y(o.$t("viewGenerationInfo")),1)]),_:1}),A(c,{key:"tiktokView"},{default:k(()=>[I(y(o.$t("tiktokView")),1)]),_:1}),A(v),((w=M(t).conf)==null?void 0:w.launch_mode)!=="server"?(a(),h(V,{key:0},[A(c,{key:"send2txt2img"},{default:k(()=>[I(y(o.$t("sendToTxt2img")),1)]),_:1}),A(c,{key:"send2img2img"},{default:k(()=>[I(y(o.$t("sendToImg2img")),1)]),_:1}),A(c,{key:"send2inpaint"},{default:k(()=>[I(y(o.$t("sendToInpaint")),1)]),_:1}),A(c,{key:"send2extras"},{default:k(()=>[I(y(o.$t("sendToExtraFeatures")),1)]),_:1}),A(b,{key:"sendToThirdPartyExtension",title:o.$t("sendToThirdPartyExtension")},{default:k(()=>[A(c,{key:"send2controlnet-txt2img"},{default:k(()=>[I("ControlNet - "+y(o.$t("t2i")),1)]),_:1}),A(c,{key:"send2controlnet-img2img"},{default:k(()=>[I("ControlNet - "+y(o.$t("i2i")),1)]),_:1}),A(c,{key:"send2outpaint"},{default:k(()=>[I("openOutpaint")]),_:1})]),_:1},8,["title"])],64)):S("",!0),A(c,{key:"send2BatchDownload"},{default:k(()=>[I(y(o.$t("sendToBatchDownload")),1)]),_:1}),A(b,{key:"copy2target",title:o.$t("copyTo")},{default:k(()=>[(a(!0),h(V,null,J(M(t).quickMovePaths,T=>(a(),R(c,{key:`copy-to-${T.dir}`},{default:k(()=>[I(y(T.zh),1)]),_:2},1024))),128))]),_:1},8,["title"]),A(b,{key:"move2target",title:o.$t("moveTo")},{default:k(()=>[(a(!0),h(V,null,J(M(t).quickMovePaths,T=>(a(),R(c,{key:`move-to-${T.dir}`},{default:k(()=>[I(y(T.zh),1)]),_:2},1024))),128))]),_:1},8,["title"]),A(v),o.isSelectedMutilFiles?(a(),h(V,{key:1},[A(b,{key:"batch-add-tag",title:o.$t("batchAddTag")},{default:k(()=>[A(c,{key:"add-custom-tag"},{default:k(()=>[I("+ "+y(o.$t("addNewCustomTag")),1)]),_:1}),(a(!0),h(V,null,J(s.value,T=>(a(),R(c,{key:`batch-add-tag-${T.id}`},{default:k(()=>[I(y(T.name),1)]),_:2},1024))),128))]),_:1},8,["title"]),A(b,{key:"batch-remove-tag",title:o.$t("batchRemoveTag")},{default:k(()=>[(a(!0),h(V,null,J(s.value,T=>(a(),R(c,{key:`batch-remove-tag-${T.id}`},{default:k(()=>[I(y(T.name),1)]),_:2},1024))),128))]),_:1},8,["title"])],64)):(a(),R(b,{key:"toggle-tag",title:o.$t("toggleTag")},{default:k(()=>[A(c,{key:"add-custom-tag"},{default:k(()=>[I("+ "+y(o.$t("addNewCustomTag")),1)]),_:1}),(a(!0),h(V,null,J(s.value,T=>(a(),R(c,{key:`toggle-tag-${T.id}`},{default:k(()=>[I(y(T.name)+" ",1),T.selected?(a(),R(M(st),{key:0})):(a(),R(M(rt),{key:1}))]),_:2},1024))),128))]),_:1},8,["title"])),A(v),A(c,{key:"openFileLocationInNewTab"},{default:k(()=>[I(y(o.$t("openFileLocationInNewTab")),1)]),_:1}),A(c,{key:"openWithLocalFileBrowser"},{default:k(()=>[I(y(o.$t("openWithLocalFileBrowser")),1)]),_:1})],64)):S("",!0),A(v),A(c,{key:"rename"},{default:k(()=>[I(y(o.$t("rename")),1)]),_:1}),A(c,{key:"previewInNewWindow"},{default:k(()=>[I(y(o.$t("previewInNewWindow")),1)]),_:1}),A(c,{key:"download"},{default:k(()=>[I(y(o.$t("download")),1)]),_:1}),A(c,{key:"copyPreviewUrl"},{default:k(()=>[I(y(o.$t("copySourceFilePreviewLink")),1)]),_:1}),A(c,{key:"copyFilePath"},{default:k(()=>[I(y(o.$t("copyFilePath")),1)]),_:1})],64)):S("",!0)]}),_:1})}}}),D=i=>(Ye("data-v-78cd67a3"),i=i(),Ze(),i),hi={class:"changeIndicatorWrapper"},gi={key:0,class:"changeIndicatorsLeft changeIndicators"},pi={key:0,class:"promptChangeIndicator changeIndicator"},vi={key:1,class:"negpromptChangeIndicator changeIndicator"},mi={key:2,class:"seedChangeIndicator changeIndicator"},yi={key:3,class:"stepsChangeIndicator changeIndicator"},bi={key:4,class:"cfgChangeIndicator changeIndicator"},Ai={key:5,class:"sizeChangeIndicator changeIndicator"},Si={key:6,class:"modelChangeIndicator changeIndicator"},ki={key:7,class:"samplerChangeIndicator changeIndicator"},Ii={key:8,class:"otherChangeIndicator changeIndicator"},_i={class:"hoverOverlay"},Ci=D(()=>u("strong",null,"This file",-1)),wi=D(()=>u("br",null,null,-1)),Ei=D(()=>u("br",null,null,-1)),Ti={key:0},Pi=D(()=>u("td",null,[u("span",{class:"promptChangeIndicator"},"+ Prompt")],-1)),Oi={key:1},Di=D(()=>u("td",null,[u("span",{class:"negpromptChangeIndicator"},"- Prompt")],-1)),Ni={key:2},zi=D(()=>u("td",null,[u("span",{class:"seedChangeIndicator"},"Seed")],-1)),Qi={key:3},$i=D(()=>u("td",null,[u("span",{class:"stepsChangeIndicator"},"Steps")],-1)),Mi={key:4},Bi=D(()=>u("td",null,[u("span",{class:"cfgChangeIndicator"},"Cfg Scale")],-1)),Fi={key:5},Ri=D(()=>u("td",null,[u("span",{class:"sizeChangeIndicator"},"Size")],-1)),Li={key:6},ji=D(()=>u("td",null,[u("span",{class:"modelChangeIndicator"},"Model")],-1)),Vi=D(()=>u("br",null,null,-1)),Hi={key:7},xi=D(()=>u("td",null,[u("span",{class:"samplerChangeIndicator"},"Sampler")],-1)),Ui=D(()=>u("br",null,null,-1)),Ji=D(()=>u("br",null,null,-1)),Wi={key:0},Ki=D(()=>u("span",{class:"otherChangeIndicator"},"Other",-1)),qi=D(()=>u("br",null,null,-1)),Gi=D(()=>u("br",null,null,-1)),Yi={key:1,class:"changeIndicatorsRight changeIndicators"},Zi={key:0,class:"promptChangeIndicator changeIndicator"},Xi={key:1,class:"negpromptChangeIndicator changeIndicator"},es={key:2,class:"seedChangeIndicator changeIndicator"},ts={key:3,class:"stepsChangeIndicator changeIndicator"},ns={key:4,class:"cfgChangeIndicator changeIndicator"},is={key:5,class:"sizeChangeIndicator changeIndicator"},ss={key:6,class:"modelChangeIndicator changeIndicator"},rs={key:7,class:"samplerChangeIndicator changeIndicator"},os={key:8,class:"otherChangeIndicator changeIndicator"},ls={class:"hoverOverlay"},as=D(()=>u("strong",null,"This file",-1)),us=D(()=>u("br",null,null,-1)),ds=D(()=>u("br",null,null,-1)),cs={key:0},fs=D(()=>u("td",null,[u("span",{class:"promptChangeIndicator"},"+ Prompt")],-1)),hs={key:1},gs=D(()=>u("td",null,[u("span",{class:"negpromptChangeIndicator"},"- Prompt")],-1)),ps={key:2},vs=D(()=>u("td",null,[u("span",{class:"seedChangeIndicator"},"Seed")],-1)),ms={key:3},ys=D(()=>u("td",null,[u("span",{class:"stepsChangeIndicator"},"Steps")],-1)),bs={key:4},As=D(()=>u("td",null,[u("span",{class:"cfgChangeIndicator"},"Cfg Scale")],-1)),Ss={key:5},ks=D(()=>u("td",null,[u("span",{class:"sizeChangeIndicator"},"Size")],-1)),Is={key:6},_s=D(()=>u("td",null,[u("span",{class:"modelChangeIndicator"},"Model")],-1)),Cs=D(()=>u("br",null,null,-1)),ws={key:7},Es=D(()=>u("td",null,[u("span",{class:"samplerChangeIndicator"},"Sampler")],-1)),Ts=D(()=>u("br",null,null,-1)),Ps=D(()=>u("br",null,null,-1)),Os={key:0},Ds=D(()=>u("span",{class:"otherChangeIndicator"},"Other",-1)),Ns=D(()=>u("br",null,null,-1)),zs=D(()=>u("br",null,null,-1)),Qs=Z({__name:"ChangeIndicator",props:{genDiffToPrevious:{},genDiffToNext:{},genInfo:{}},setup(i){function n(t){const s=["prompt","negativePrompt","seed","steps","cfgScale","size","Model","others"],o=Object.keys(t).filter(p=>!s.includes(p));return Object.fromEntries(o.map(p=>[p,t[p]]))}function e(t){return Object.keys(n(t)).length>0}return(t,s)=>(a(),h("div",hi,[t.genDiffToPrevious.empty?S("",!0):(a(),h("div",gi,["prompt"in t.genDiffToPrevious.diff?(a(),h("div",pi,"P+")):S("",!0),"negativePrompt"in t.genDiffToPrevious.diff?(a(),h("div",vi,"P-")):S("",!0),"seed"in t.genDiffToPrevious.diff?(a(),h("div",mi,"Se")):S("",!0),"steps"in t.genDiffToPrevious.diff?(a(),h("div",yi,"St")):S("",!0),"cfgScale"in t.genDiffToPrevious.diff?(a(),h("div",bi,"Cf")):S("",!0),"size"in t.genDiffToPrevious.diff?(a(),h("div",Ai,"Si")):S("",!0),"Model"in t.genDiffToPrevious.diff?(a(),h("div",Si,"Mo")):S("",!0),"Sampler"in t.genDiffToPrevious.diff?(a(),h("div",ki,"Sa")):S("",!0),e(t.genDiffToPrevious.diff)?(a(),h("div",Ii,"Ot")):S("",!0)])),u("div",_i,[u("small",null,[A(M(Re)),Ci,I(" vs "+y(t.genDiffToPrevious.otherFile)+" ",1),wi,Ei,u("table",null,["prompt"in t.genDiffToPrevious.diff?(a(),h("tr",Ti,[Pi,u("td",null,y(t.genDiffToPrevious.diff.prompt)+" tokens changed",1)])):S("",!0),"negativePrompt"in t.genDiffToPrevious.diff?(a(),h("tr",Oi,[Di,u("td",null,y(t.genDiffToPrevious.diff.negativePrompt)+" tokens changed",1)])):S("",!0),"seed"in t.genDiffToPrevious.diff?(a(),h("tr",Ni,[zi,u("td",null,[u("strong",null,y(t.genDiffToPrevious.diff.seed[0]),1),I(" vs "+y(t.genDiffToPrevious.diff.seed[1]),1)])])):S("",!0),"steps"in t.genDiffToPrevious.diff?(a(),h("tr",Qi,[$i,u("td",null,[u("strong",null,y(t.genDiffToPrevious.diff.steps[0]),1),I(" vs "+y(t.genDiffToPrevious.diff.steps[1]),1)])])):S("",!0),"cfgScale"in t.genDiffToPrevious.diff?(a(),h("tr",Mi,[Bi,u("td",null,[u("strong",null,y(t.genDiffToPrevious.diff.cfgScale[0]),1),I(" vs "+y(t.genDiffToPrevious.diff.cfgScale[1]),1)])])):S("",!0),"size"in t.genDiffToPrevious.diff?(a(),h("tr",Fi,[Ri,u("td",null,[u("strong",null,y(t.genDiffToPrevious.diff.size[0]),1),I(" vs "+y(t.genDiffToPrevious.diff.size[1]),1)])])):S("",!0),"Model"in t.genDiffToPrevious.diff?(a(),h("tr",Li,[ji,u("td",null,[u("strong",null,y(t.genDiffToPrevious.diff.Model[0]),1),Vi,I(" vs "+y(t.genDiffToPrevious.diff.Model[1]),1)])])):S("",!0),"Sampler"in t.genDiffToPrevious.diff?(a(),h("tr",Hi,[xi,u("td",null,[u("strong",null,y(t.genDiffToPrevious.diff.Sampler[0]),1),Ui,I(" vs "+y(t.genDiffToPrevious.diff.Sampler[1]),1)])])):S("",!0)]),Ji,e(t.genDiffToPrevious.diff)?(a(),h("div",Wi,[Ki,I(" props that changed:"),qi,Gi,u("ul",null,[(a(!0),h(V,null,J(n(t.genDiffToPrevious.diff),(o,p)=>(a(),h("li",null,y(p),1))),256))])])):S("",!0)])]),t.genDiffToNext.empty?S("",!0):(a(),h("div",Yi,["prompt"in t.genDiffToNext.diff?(a(),h("div",Zi,"P+")):S("",!0),"negativePrompt"in t.genDiffToNext.diff?(a(),h("div",Xi,"P-")):S("",!0),"seed"in t.genDiffToNext.diff?(a(),h("div",es,"Se")):S("",!0),"steps"in t.genDiffToNext.diff?(a(),h("div",ts,"St")):S("",!0),"cfgScale"in t.genDiffToNext.diff?(a(),h("div",ns,"Cf")):S("",!0),"size"in t.genDiffToNext.diff?(a(),h("div",is,"Si")):S("",!0),"Model"in t.genDiffToNext.diff?(a(),h("div",ss,"Mo")):S("",!0),"Sampler"in t.genDiffToNext.diff?(a(),h("div",rs,"Sa")):S("",!0),e(t.genDiffToNext.diff)?(a(),h("div",os,"Ot")):S("",!0)])),u("div",ls,[u("small",null,[A(M(Re)),as,I(" vs "+y(t.genDiffToNext.otherFile)+" ",1),us,ds,u("table",null,["prompt"in t.genDiffToNext.diff?(a(),h("tr",cs,[fs,u("td",null,y(t.genDiffToNext.diff.prompt)+" tokens changed",1)])):S("",!0),"negativePrompt"in t.genDiffToNext.diff?(a(),h("tr",hs,[gs,u("td",null,y(t.genDiffToNext.diff.negativePrompt)+" tokens changed",1)])):S("",!0),"seed"in t.genDiffToNext.diff?(a(),h("tr",ps,[vs,u("td",null,[u("strong",null,y(t.genDiffToNext.diff.seed[0]),1),I(" vs "+y(t.genDiffToNext.diff.seed[1]),1)])])):S("",!0),"steps"in t.genDiffToNext.diff?(a(),h("tr",ms,[ys,u("td",null,[u("strong",null,y(t.genDiffToNext.diff.steps[0]),1),I(" vs "+y(t.genDiffToNext.diff.steps[1]),1)])])):S("",!0),"cfgScale"in t.genDiffToNext.diff?(a(),h("tr",bs,[As,u("td",null,[u("strong",null,y(t.genDiffToNext.diff.cfgScale[0]),1),I(" vs "+y(t.genDiffToNext.diff.cfgScale[1]),1)])])):S("",!0),"size"in t.genDiffToNext.diff?(a(),h("tr",Ss,[ks,u("td",null,[u("strong",null,y(t.genDiffToNext.diff.size[0]),1),I(" vs "+y(t.genDiffToNext.diff.size[1]),1)])])):S("",!0),"Model"in t.genDiffToNext.diff?(a(),h("tr",Is,[_s,u("td",null,[u("strong",null,y(t.genDiffToNext.diff.Model[0]),1),Cs,I(" vs "+y(t.genDiffToNext.diff.Model[1]),1)])])):S("",!0),"Sampler"in t.genDiffToNext.diff?(a(),h("tr",ws,[Es,u("td",null,[u("strong",null,y(t.genDiffToNext.diff.Sampler[0]),1),Ts,I(" vs "+y(t.genDiffToNext.diff.Sampler[1]),1)])])):S("",!0)]),Ps,e(t.genDiffToNext.diff)?(a(),h("div",Os,[Ds,I(" props that changed:"),Ns,zs,u("ul",null,[(a(!0),h(V,null,J(n(t.genDiffToNext.diff),(o,p)=>(a(),h("li",null,y(p),1))),256))])])):S("",!0)])])]))}});const $s=it(Qs,[["__scopeId","data-v-78cd67a3"]]),Ms=["data-idx"],Bs={key:1,class:"more"},Fs={class:"float-btn-wrap"},Rs={key:1,class:"tags-container"},Ls=["url"],js={class:"play-icon"},Vs=["src"],Hs={key:0,class:"tags-container"},xs={key:4,class:"preview-icon-wrap"},Us={key:1,class:"dir-cover-container"},Js=["src"],Ws={key:5,class:"profile"},Ks=["title"],qs={class:"basic-info"},Gs={style:{"margin-right":"4px"}},he=160,Ys=Z({__name:"FileItem",props:{file:{},idx:{},selected:{type:Boolean,default:!1},showMenuIdx:{},cellWidth:{},fullScreenPreviewImageUrl:{},enableRightClickMenu:{type:Boolean,default:!0},enableCloseIcon:{type:Boolean,default:!1},isSelectedMutilFiles:{type:Boolean},genInfo:{},enableChangeIndicator:{type:Boolean},extraTags:{},coverFiles:{},getGenDiff:{},getGenDiffWatchDep:{}},emits:["update:showMenuIdx","fileItemClick","dragstart","dragend","previewVisibleChange","contextMenuClick","close-icon-click","tiktokView"],setup(i,{emit:n}){const e=i;Wt(l=>({"703c27e9":l.$props.cellWidth+"px"}));const t=Ie(),s=qe(),o=j(),p=j(),c=pe(()=>{const{getGenDiff:l,file:r,idx:d}=e;l&&(p.value=l(r.gen_info_obj,d,1,r),o.value=l(r.gen_info_obj,d,-1,r))},200+100*Math.random());re(()=>{var l;return(l=e.getGenDiffWatchDep)==null?void 0:l.call(e,e.idx)},()=>{c()},{immediate:!0,deep:!0});const v=H(()=>s.tagMap.get(e.file.fullpath)??[]),b=H(()=>{const l=t.gridThumbnailResolution;return t.enableThumbnail?Qe(e.file,[l,l].join("x")):Kt(e.file)}),E=H(()=>{var l;return(((l=t.conf)==null?void 0:l.all_custom_tags)??[]).reduce((r,d)=>[...r,{...d,selected:!!v.value.find(m=>m.id===d.id)}],[])}),w=H(()=>E.value.find(l=>l.type==="custom"&&l.name==="like")),T=()=>{ge(w.value),n("contextMenuClick",{key:`toggle-tag-${w.value.id}`},e.file,e.idx)};return(l,r)=>{const d=G,m=tt,N=nt,O=nn,z=dn;return a(),R(d,{trigger:["contextmenu"],visible:M(t).longPressOpenContextMenu?typeof l.idx=="number"&&l.showMenuIdx===l.idx:void 0,"onUpdate:visible":r[8]||(r[8]=g=>typeof l.idx=="number"&&n("update:showMenuIdx",g?l.idx:-1))},{overlay:k(()=>[l.enableRightClickMenu?(a(),R(xe,{key:0,file:l.file,idx:l.idx,"selected-tag":v.value,onContextMenuClick:r[7]||(r[7]=(g,f,C)=>n("contextMenuClick",g,f,C)),"is-selected-mutil-files":l.isSelectedMutilFiles},null,8,["file","idx","selected-tag","is-selected-mutil-files"])):S("",!0)]),default:k(()=>{var g;return[(a(),h("li",{class:K(["file file-item-trigger grid",{clickable:l.file.type==="dir",selected:l.selected}]),"data-idx":l.idx,key:l.file.name,draggable:"true",onDragstart:r[4]||(r[4]=f=>n("dragstart",f,l.idx)),onDragend:r[5]||(r[5]=f=>n("dragend",f,l.idx)),onClickCapture:r[6]||(r[6]=f=>n("fileItemClick",f,l.file,l.idx))},[u("div",null,[l.enableCloseIcon?(a(),h("div",{key:0,class:"close-icon",onClick:r[0]||(r[0]=f=>n("close-icon-click"))},[A(M(qt))])):S("",!0),l.enableRightClickMenu?(a(),h("div",Bs,[A(d,null,{overlay:k(()=>[A(xe,{file:l.file,idx:l.idx,"selected-tag":v.value,onContextMenuClick:r[1]||(r[1]=(f,C,$)=>n("contextMenuClick",f,C,$)),"is-selected-mutil-files":l.isSelectedMutilFiles},null,8,["file","idx","selected-tag","is-selected-mutil-files"])]),default:k(()=>[u("div",Fs,[A(M(Gt))])]),_:1}),l.file.type==="file"?(a(),R(d,{key:0},{overlay:k(()=>[E.value.length>1?(a(),R(N,{key:0,onClick:r[2]||(r[2]=f=>n("contextMenuClick",f,l.file,l.idx))},{default:k(()=>[(a(!0),h(V,null,J(E.value,f=>(a(),R(m,{key:`toggle-tag-${f.id}`},{default:k(()=>[I(y(f.name)+" ",1),f.selected?(a(),R(M(st),{key:0})):(a(),R(M(rt),{key:1}))]),_:2},1024))),128))]),_:1})):S("",!0)]),default:k(()=>{var f,C;return[u("div",{class:K(["float-btn-wrap",{"like-selected":(f=w.value)==null?void 0:f.selected}]),onClick:T},[(C=w.value)!=null&&C.selected?(a(),R(M(Yt),{key:0})):(a(),R(M(Zt),{key:1}))],2)]}),_:1})):S("",!0)])):S("",!0),M(Xt)(l.file.name)?(a(),h("div",{key:l.file.fullpath,class:K(`idx-${l.idx} item-content`)},[l.enableChangeIndicator&&p.value&&o.value?(a(),R($s,{key:0,"gen-diff-to-next":p.value,"gen-diff-to-previous":o.value},null,8,["gen-diff-to-next","gen-diff-to-previous"])):S("",!0),A(O,{src:b.value,fallback:M(Pn),preview:{src:l.fullScreenPreviewImageUrl,onVisibleChange:(f,C)=>n("previewVisibleChange",f,C)}},null,8,["src","fallback","preview"]),v.value&&l.cellWidth>he?(a(),h("div",Rs,[(a(!0),h(V,null,J(l.extraTags??v.value,f=>(a(),R(z,{key:f.id,color:M(s).getColor(f)},{default:k(()=>[I(y(f.name),1)]),_:2},1032,["color"]))),128))])):S("",!0)],2)):M(en)(l.file.name)?(a(),h("div",{key:3,class:K(`idx-${l.idx} item-content video`),url:M(ce)(l.file),style:et({"background-image":`url('${l.file.cover_url??M(ce)(l.file)}')`}),onClick:r[3]||(r[3]=f=>M(tn)(l.file,C=>n("contextMenuClick",{key:`toggle-tag-${C}`},l.file,l.idx),()=>n("tiktokView",l.file,l.idx)))},[u("div",js,[u("img",{src:M(Bn),style:{width:"40px",height:"40px"}},null,8,Vs)]),v.value&&l.cellWidth>he?(a(),h("div",Hs,[(a(!0),h(V,null,J(v.value,f=>(a(),R(z,{key:f.id,color:M(s).getColor(f)},{default:k(()=>[I(y(f.name),1)]),_:2},1032,["color"]))),128))])):S("",!0)],14,Ls)):(a(),h("div",xs,[l.file.type==="file"?(a(),R(M(mn),{key:0,class:"icon center"})):(g=l.coverFiles)!=null&&g.length&&l.cellWidth>160?(a(),h("div",Us,[(a(!0),h(V,null,J(l.coverFiles,f=>(a(),h("img",{class:"dir-cover-item",src:f.media_type==="image"?M(Qe)(f):M(ce)(f),key:f.fullpath},null,8,Js))),128))])):(a(),R(M(Sn),{key:2,class:"icon center"}))])),l.cellWidth>he?(a(),h("div",Ws,[u("div",{class:"name line-clamp-1",title:l.file.name},y(l.file.name),9,Ks),u("div",qs,[u("div",Gs,y(l.file.type)+" "+y(l.file.size),1),u("div",null,y(l.file.date),1)])])):S("",!0)])],42,Ms))]}),_:1},8,["visible"])}}});const gr=it(Ys,[["__scopeId","data-v-efdfc9d7"]]);export{gr as F,sr as N,xe as _,rr as a,hr as b,fr as c,ct as d,cr as e,Fn as f,q as g,ar as h,dr as i,lr as j,ur as k,Tn as r,or as s,Ln as t,le as u};
